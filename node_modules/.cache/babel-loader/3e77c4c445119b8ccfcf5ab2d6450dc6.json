{"ast":null,"code":"import { useMemo, useReducer, useEffect, useRef } from 'react';\n\nvar snapshotToData = function (snapshot, snapshotOptions, idField, refField, transform) {\n  if (!snapshot.exists) {\n    return undefined;\n  }\n\n  var data = snapshot.data(snapshotOptions);\n\n  if (transform) {\n    data = transform(data);\n  }\n\n  if (idField) {\n    data[idField] = snapshot.id;\n  }\n\n  if (refField) {\n    data[refField] = snapshot.ref;\n  }\n\n  return data;\n};\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar defaultState = function (defaultValue) {\n  return {\n    loading: defaultValue === undefined || defaultValue === null,\n    value: defaultValue\n  };\n};\n\nvar reducer = function () {\n  return function (state, action) {\n    switch (action.type) {\n      case 'error':\n        return __assign({}, state, {\n          error: action.error,\n          loading: false,\n          value: undefined\n        });\n\n      case 'reset':\n        return defaultState(action.defaultValue);\n\n      case 'value':\n        return __assign({}, state, {\n          error: undefined,\n          loading: false,\n          value: action.value\n        });\n\n      default:\n        return state;\n    }\n  };\n};\n\nvar useLoadingValue = function (getDefaultValue) {\n  var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n\n  var _a = useReducer(reducer(), defaultState(defaultValue)),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var reset = function () {\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n    dispatch({\n      type: 'reset',\n      defaultValue: defaultValue\n    });\n  };\n\n  var setError = function (error) {\n    dispatch({\n      type: 'error',\n      error: error\n    });\n  };\n\n  var setValue = function (value) {\n    dispatch({\n      type: 'value',\n      value: value\n    });\n  };\n\n  return useMemo(function () {\n    return {\n      error: state.error,\n      loading: state.loading,\n      reset: reset,\n      setError: setError,\n      setValue: setValue,\n      value: state.value\n    };\n  }, [state.error, state.loading, reset, setError, setValue, state.value]);\n};\n\nvar useComparatorRef = function (value, isEqual, onChange) {\n  var ref = useRef(value);\n  useEffect(function () {\n    if (!isEqual(value, ref.current)) {\n      ref.current = value;\n\n      if (onChange) {\n        onChange();\n      }\n    }\n  });\n  return ref;\n};\n\nvar isEqual = function (v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && v1.isEqual(v2);\n  return bothNull || equal;\n};\n\nvar useIsEqualRef = function (value, onChange) {\n  return useComparatorRef(value, isEqual, onChange);\n};\n\nvar useCollection = function (query, options) {\n  return useCollectionInternal(true, query, options);\n};\n\nvar useCollectionOnce = function (query, options) {\n  return useCollectionInternal(false, query, options);\n};\n\nvar useCollectionData = function (query, options) {\n  return useCollectionDataInternal(true, query, options);\n};\n\nvar useCollectionDataOnce = function (query, options) {\n  return useCollectionDataInternal(false, query, options);\n};\n\nvar useCollectionInternal = function (listen, query, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(query, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    if (listen) {\n      var listener_1 = options && options.snapshotListenOptions ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError) : ref.current.onSnapshot(setValue, setError);\n      return function () {\n        listener_1();\n      };\n    } else {\n      ref.current.get(options ? options.getOptions : undefined).then(setValue).catch(setError);\n    }\n  }, [ref.current]);\n  var resArray = [value, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nvar useCollectionDataInternal = function (listen, query, options) {\n  var idField = options ? options.idField : undefined;\n  var refField = options ? options.refField : undefined;\n  var snapshotOptions = options ? options.snapshotOptions : undefined;\n  var transform = options ? options.transform : undefined;\n\n  var _a = useCollectionInternal(listen, query, options),\n      snapshots = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var values = useMemo(function () {\n    return snapshots ? snapshots.docs.map(function (doc) {\n      return snapshotToData(doc, snapshotOptions, idField, refField, transform);\n    }) : undefined;\n  }, [snapshots, snapshotOptions, idField, refField, transform]);\n  var resArray = [values, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nvar useDocument = function (docRef, options) {\n  return useDocumentInternal(true, docRef, options);\n};\n\nvar useDocumentOnce = function (docRef, options) {\n  return useDocumentInternal(false, docRef, options);\n};\n\nvar useDocumentData = function (docRef, options) {\n  return useDocumentDataInternal(true, docRef, options);\n};\n\nvar useDocumentDataOnce = function (docRef, options) {\n  return useDocumentDataInternal(false, docRef, options);\n};\n\nvar useDocumentInternal = function (listen, docRef, options) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(docRef, reset);\n  useEffect(function () {\n    if (!ref.current) {\n      setValue(undefined);\n      return;\n    }\n\n    if (listen) {\n      var listener_1 = options && options.snapshotListenOptions ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError) : ref.current.onSnapshot(setValue, setError);\n      return function () {\n        listener_1();\n      };\n    } else {\n      ref.current.get(options ? options.getOptions : undefined).then(setValue).catch(setError);\n    }\n  }, [ref.current]);\n  var resArray = [value, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nvar useDocumentDataInternal = function (listen, docRef, options) {\n  var idField = options ? options.idField : undefined;\n  var refField = options ? options.refField : undefined;\n  var snapshotOptions = options ? options.snapshotOptions : undefined;\n  var transform = options ? options.transform : undefined;\n\n  var _a = useDocumentInternal(listen, docRef, options),\n      snapshot = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var value = useMemo(function () {\n    return snapshot ? snapshotToData(snapshot, snapshotOptions, idField, refField, transform) : undefined;\n  }, [snapshot, snapshotOptions, idField, refField, transform]);\n  var resArray = [value, loading, error];\n  return useMemo(function () {\n    return resArray;\n  }, resArray);\n};\n\nexport { useCollection, useCollectionOnce, useCollectionData, useCollectionDataOnce, useDocument, useDocumentData, useDocumentOnce, useDocumentDataOnce };","map":{"version":3,"sources":["/Users/ananthkashyap/Documents/GitHub/launch.everaise/node_modules/react-firebase-hooks/firestore/dist/index.esm.js"],"names":["useMemo","useReducer","useEffect","useRef","snapshotToData","snapshot","snapshotOptions","idField","refField","transform","exists","undefined","data","id","ref","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defaultState","defaultValue","loading","value","reducer","state","action","type","error","useLoadingValue","getDefaultValue","_a","dispatch","reset","setError","setValue","useComparatorRef","isEqual","onChange","current","v1","v2","bothNull","equal","useIsEqualRef","useCollection","query","options","useCollectionInternal","useCollectionOnce","useCollectionData","useCollectionDataInternal","useCollectionDataOnce","listen","listener_1","snapshotListenOptions","onSnapshot","get","getOptions","then","catch","resArray","snapshots","values","docs","map","doc","useDocument","docRef","useDocumentInternal","useDocumentOnce","useDocumentData","useDocumentDataInternal","useDocumentDataOnce"],"mappings":"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","sourcesContent":["import { useMemo, useReducer, useEffect, useRef } from 'react';\n\nvar snapshotToData = function (snapshot, snapshotOptions, idField, refField, transform) {\r\n    if (!snapshot.exists) {\r\n        return undefined;\r\n    }\r\n    var data = snapshot.data(snapshotOptions);\r\n    if (transform) {\r\n        data = transform(data);\r\n    }\r\n    if (idField) {\r\n        data[idField] = snapshot.id;\r\n    }\r\n    if (refField) {\r\n        data[refField] = snapshot.ref;\r\n    }\r\n    return data;\r\n};\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar defaultState = function (defaultValue) {\r\n    return {\r\n        loading: defaultValue === undefined || defaultValue === null,\r\n        value: defaultValue,\r\n    };\r\n};\r\nvar reducer = function () { return function (state, action) {\r\n    switch (action.type) {\r\n        case 'error':\r\n            return __assign({}, state, { error: action.error, loading: false, value: undefined });\r\n        case 'reset':\r\n            return defaultState(action.defaultValue);\r\n        case 'value':\r\n            return __assign({}, state, { error: undefined, loading: false, value: action.value });\r\n        default:\r\n            return state;\r\n    }\r\n}; };\r\nvar useLoadingValue = (function (getDefaultValue) {\r\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n    var _a = useReducer(reducer(), defaultState(defaultValue)), state = _a[0], dispatch = _a[1];\r\n    var reset = function () {\r\n        var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n        dispatch({ type: 'reset', defaultValue: defaultValue });\r\n    };\r\n    var setError = function (error) {\r\n        dispatch({ type: 'error', error: error });\r\n    };\r\n    var setValue = function (value) {\r\n        dispatch({ type: 'value', value: value });\r\n    };\r\n    return useMemo(function () { return ({\r\n        error: state.error,\r\n        loading: state.loading,\r\n        reset: reset,\r\n        setError: setError,\r\n        setValue: setValue,\r\n        value: state.value,\r\n    }); }, [state.error, state.loading, reset, setError, setValue, state.value]);\r\n});\n\nvar useComparatorRef = function (value, isEqual, onChange) {\r\n    var ref = useRef(value);\r\n    useEffect(function () {\r\n        if (!isEqual(value, ref.current)) {\r\n            ref.current = value;\r\n            if (onChange) {\r\n                onChange();\r\n            }\r\n        }\r\n    });\r\n    return ref;\r\n};\r\nvar isEqual = function (v1, v2) {\r\n    var bothNull = !v1 && !v2;\r\n    var equal = !!v1 && !!v2 && v1.isEqual(v2);\r\n    return bothNull || equal;\r\n};\r\nvar useIsEqualRef = function (value, onChange) {\r\n    return useComparatorRef(value, isEqual, onChange);\r\n};\n\nvar useCollection = function (query, options) {\r\n    return useCollectionInternal(true, query, options);\r\n};\r\nvar useCollectionOnce = function (query, options) {\r\n    return useCollectionInternal(false, query, options);\r\n};\r\nvar useCollectionData = function (query, options) {\r\n    return useCollectionDataInternal(true, query, options);\r\n};\r\nvar useCollectionDataOnce = function (query, options) {\r\n    return useCollectionDataInternal(false, query, options);\r\n};\r\nvar useCollectionInternal = function (listen, query, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(query, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        if (listen) {\r\n            var listener_1 = options && options.snapshotListenOptions\r\n                ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError)\r\n                : ref.current.onSnapshot(setValue, setError);\r\n            return function () {\r\n                listener_1();\r\n            };\r\n        }\r\n        else {\r\n            ref.current\r\n                .get(options ? options.getOptions : undefined)\r\n                .then(setValue)\r\n                .catch(setError);\r\n        }\r\n    }, [ref.current]);\r\n    var resArray = [\r\n        value,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\r\nvar useCollectionDataInternal = function (listen, query, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var refField = options ? options.refField : undefined;\r\n    var snapshotOptions = options ? options.snapshotOptions : undefined;\r\n    var transform = options ? options.transform : undefined;\r\n    var _a = useCollectionInternal(listen, query, options), snapshots = _a[0], loading = _a[1], error = _a[2];\r\n    var values = useMemo(function () {\r\n        return (snapshots\r\n            ? snapshots.docs.map(function (doc) {\r\n                return snapshotToData(doc, snapshotOptions, idField, refField, transform);\r\n            })\r\n            : undefined);\r\n    }, [snapshots, snapshotOptions, idField, refField, transform]);\r\n    var resArray = [\r\n        values,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\n\nvar useDocument = function (docRef, options) {\r\n    return useDocumentInternal(true, docRef, options);\r\n};\r\nvar useDocumentOnce = function (docRef, options) {\r\n    return useDocumentInternal(false, docRef, options);\r\n};\r\nvar useDocumentData = function (docRef, options) {\r\n    return useDocumentDataInternal(true, docRef, options);\r\n};\r\nvar useDocumentDataOnce = function (docRef, options) {\r\n    return useDocumentDataInternal(false, docRef, options);\r\n};\r\nvar useDocumentInternal = function (listen, docRef, options) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(docRef, reset);\r\n    useEffect(function () {\r\n        if (!ref.current) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        if (listen) {\r\n            var listener_1 = options && options.snapshotListenOptions\r\n                ? ref.current.onSnapshot(options.snapshotListenOptions, setValue, setError)\r\n                : ref.current.onSnapshot(setValue, setError);\r\n            return function () {\r\n                listener_1();\r\n            };\r\n        }\r\n        else {\r\n            ref.current\r\n                .get(options ? options.getOptions : undefined)\r\n                .then(setValue)\r\n                .catch(setError);\r\n        }\r\n    }, [ref.current]);\r\n    var resArray = [\r\n        value,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\r\nvar useDocumentDataInternal = function (listen, docRef, options) {\r\n    var idField = options ? options.idField : undefined;\r\n    var refField = options ? options.refField : undefined;\r\n    var snapshotOptions = options ? options.snapshotOptions : undefined;\r\n    var transform = options ? options.transform : undefined;\r\n    var _a = useDocumentInternal(listen, docRef, options), snapshot = _a[0], loading = _a[1], error = _a[2];\r\n    var value = useMemo(function () {\r\n        return (snapshot\r\n            ? snapshotToData(snapshot, snapshotOptions, idField, refField, transform)\r\n            : undefined);\r\n    }, [snapshot, snapshotOptions, idField, refField, transform]);\r\n    var resArray = [\r\n        value,\r\n        loading,\r\n        error,\r\n    ];\r\n    return useMemo(function () { return resArray; }, resArray);\r\n};\n\nexport { useCollection, useCollectionOnce, useCollectionData, useCollectionDataOnce, useDocument, useDocumentData, useDocumentOnce, useDocumentDataOnce };\n"]},"metadata":{},"sourceType":"module"}